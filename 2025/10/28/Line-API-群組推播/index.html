<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Line-API-群組推播 | HaoAreYou~</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="自己做了一個Side Project，會用到Line API的推播，但後來測試發現一次只能有一個Line帳號收到Line BOT的推播訊息，這篇記錄把原本的只有單人能收到推播訊息，改成把訊息推播到群組，讓有加入群組的人都可以收到推播訊息。">
<meta property="og:type" content="article">
<meta property="og:title" content="Line-API-群組推播">
<meta property="og:url" content="http://example.com/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/index.html">
<meta property="og:site_name" content="HaoAreYou~">
<meta property="og:description" content="自己做了一個Side Project，會用到Line API的推播，但後來測試發現一次只能有一個Line帳號收到Line BOT的推播訊息，這篇記錄把原本的只有單人能收到推播訊息，改成把訊息推播到群組，讓有加入群組的人都可以收到推播訊息。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/open_group_chat.jpg">
<meta property="og:image" content="http://example.com/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/build.jpg">
<meta property="og:image" content="http://example.com/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/open_webhook.jpg">
<meta property="og:image" content="http://example.com/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/test_result.jpg">
<meta property="article:published_time" content="2025-10-28T06:51:26.000Z">
<meta property="article:modified_time" content="2025-10-28T07:37:55.267Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Cloud Run">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/open_group_chat.jpg">
  
    <link rel="alternate" href="/atom.xml" title="HaoAreYou~" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">HaoAreYou~</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">菜鳥工程師，如文章內容有誤請來信指教修正，避免誤人子弟...</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Line-API-群組推播" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/" class="article-date">
  <time class="dt-published" datetime="2025-10-28T06:51:26.000Z" itemprop="datePublished">2025-10-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/GCP/">GCP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Line-API-群組推播
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h5 id="自己做了一個Side-Project，會用到Line-API的推播，但後來測試發現一次只能有一個Line帳號收到Line-BOT的推播訊息，這篇記錄把原本的只有單人能收到推播訊息，改成把訊息推播到群組，讓有加入群組的人都可以收到推播訊息。"><a href="#自己做了一個Side-Project，會用到Line-API的推播，但後來測試發現一次只能有一個Line帳號收到Line-BOT的推播訊息，這篇記錄把原本的只有單人能收到推播訊息，改成把訊息推播到群組，讓有加入群組的人都可以收到推播訊息。" class="headerlink" title="自己做了一個Side Project，會用到Line API的推播，但後來測試發現一次只能有一個Line帳號收到Line BOT的推播訊息，這篇記錄把原本的只有單人能收到推播訊息，改成把訊息推播到群組，讓有加入群組的人都可以收到推播訊息。"></a>自己做了一個Side Project，會用到Line API的推播，但後來測試發現一次只能有一個Line帳號收到Line BOT的推播訊息，這篇記錄把原本的只有單人能收到推播訊息，改成把訊息推播到群組，讓有加入群組的人都可以收到推播訊息。</h5><span id="more"></span>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="-1"><a href="#-1" class="headerlink" title=""></a></h1><h1 id="-2"><a href="#-2" class="headerlink" title=""></a></h1><h1 id="-3"><a href="#-3" class="headerlink" title=""></a></h1><hr>
<h3 id="把機器人邀請進入要推播的群組"><a href="#把機器人邀請進入要推播的群組" class="headerlink" title="把機器人邀請進入要推播的群組"></a>把機器人邀請進入要推播的群組</h3><ol>
<li><h5 id="首先要先把機器人邀請進入群組"><a href="#首先要先把機器人邀請進入群組" class="headerlink" title="首先要先把機器人邀請進入群組"></a>首先要先把機器人邀請進入群組</h5></li>
<li><h5 id="要記得先到Line-Develope的Messaging-API頁籤把Allow-bot-to-join-group-chats打開"><a href="#要記得先到Line-Develope的Messaging-API頁籤把Allow-bot-to-join-group-chats打開" class="headerlink" title="要記得先到Line Develope的Messaging API頁籤把Allow bot to join group chats打開"></a>要記得先到Line Develope的Messaging API頁籤把Allow bot to join group chats打開</h5></li>
</ol>
<img src="/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/open_group_chat.jpg" class="" title="open_group_chat">
<h1 id="-4"><a href="#-4" class="headerlink" title=""></a></h1><h1 id="-5"><a href="#-5" class="headerlink" title=""></a></h1><h1 id="-6"><a href="#-6" class="headerlink" title=""></a></h1><h1 id="-7"><a href="#-7" class="headerlink" title=""></a></h1><hr>
<h3 id="Cloud-Run-設定"><a href="#Cloud-Run-設定" class="headerlink" title="Cloud Run 設定"></a>Cloud Run 設定</h3><ol>
<li><h5 id="更新node-js後端程式碼，新增路由-lineWebhook"><a href="#更新node-js後端程式碼，新增路由-lineWebhook" class="headerlink" title="更新node.js後端程式碼，新增路由 &#x2F;lineWebhook"></a>更新node.js後端程式碼，新增路由 &#x2F;lineWebhook</h5></li>
</ol>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line">const functions = require(&#x27;@google-cloud/functions-framework&#x27;);</span><br><span class="line">const fetch = require(&#x27;node-fetch&#x27;);</span><br><span class="line"></span><br><span class="line">const TOKEN = &quot;&#123;TOKEN&#125;&quot;; // 長期有效 token</span><br><span class="line">const USER_ID = &quot;&#123;接收者的 User ID&#125;&quot;; // 接收者的 User ID</span><br><span class="line"></span><br><span class="line">// 處理 CORS</span><br><span class="line">const setCorsHeaders = (res) =&gt; &#123;</span><br><span class="line">  res.set(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);</span><br><span class="line">  res.set(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, GET, OPTIONS&quot;); // 加入 GET 方法</span><br><span class="line">  res.set(&quot;Access-Control-Allow-Headers&quot;, &quot;Content-Type&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ===============================================</span><br><span class="line">// ✅ 新增：處理 Line Webhook 請求 (/lineWebhook)</span><br><span class="line">// ===============================================</span><br><span class="line">const handleLineWebhook = async (req, res) =&gt; &#123;</span><br><span class="line">  // **注意：Line Webhook 不需要 CORS 處理**</span><br><span class="line"></span><br><span class="line">  // 1. 處理預檢請求 (雖然 Line 不會發 OPTIONS，但為保險仍保留)</span><br><span class="line">  if (req.method === &quot;OPTIONS&quot;) &#123;</span><br><span class="line">    return res.status(204).send(&#x27;&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 2. 確保是 POST 請求</span><br><span class="line">  if (req.method !== &quot;POST&quot;) &#123;</span><br><span class="line">    return res.status(405).send(&quot;Method Not Allowed. Only POST is allowed for Line Webhook.&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  try &#123;</span><br><span class="line">    // 取得 Line 傳送過來的 events 陣列</span><br><span class="line">    const events = req.body.events;</span><br><span class="line"></span><br><span class="line">    // 遍歷所有事件</span><br><span class="line">    for (const event of events) &#123;</span><br><span class="line">      console.log(`Processing event: $&#123;JSON.stringify(event)&#125;`);</span><br><span class="line"></span><br><span class="line">      // 僅處理 &#x27;message&#x27; 事件 (如使用者傳送文字訊息)</span><br><span class="line">      if (event.type === &#x27;message&#x27; &amp;&amp; event.message.type === &#x27;text&#x27;) &#123;</span><br><span class="line">        const userText = event.message.text;</span><br><span class="line">        const replyToken = event.replyToken;</span><br><span class="line">        </span><br><span class="line">        let replyMessage = `您說了: $&#123;userText&#125; (此為自動回覆)`;</span><br><span class="line">        </span><br><span class="line">        // TODO: 在這裡加入您的業務邏輯，例如：</span><br><span class="line">        // if (userText === &#x27;天氣&#x27;) &#123; replyMessage = &#x27;今天天氣很好。&#x27;; &#125;</span><br><span class="line"></span><br><span class="line">        // 回覆訊息給使用者 (使用 Line Reply API)</span><br><span class="line">        await replyLineMessage(replyToken, replyMessage);</span><br><span class="line">      &#125; </span><br><span class="line">      // TODO: 可在此處加入其他事件處理，如 postback, follow, unfollow 等...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // **重要：Line 期望收到 HTTP 200 OK，表示 Webhook 接收成功**</span><br><span class="line">    return res.status(200).send(&#x27;OK&#x27;);</span><br><span class="line"></span><br><span class="line">  &#125; catch (err) &#123;</span><br><span class="line">    console.error(&quot;Line Webhook Error:&quot;, err);</span><br><span class="line">    // 即使處理失敗，建議仍返回 200，避免 Line 重複發送請求</span><br><span class="line">    return res.status(200).send(&#x27;Webhook Processed with Errors&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 輔助函數：回覆 Line 訊息</span><br><span class="line">const replyLineMessage = async (replyToken, text) =&gt; &#123;</span><br><span class="line">  const url = &quot;https://api.line.me/v2/bot/message/reply&quot;;</span><br><span class="line">  const body = JSON.stringify(&#123;</span><br><span class="line">    replyToken: replyToken,</span><br><span class="line">    messages: [&#123; type: &quot;text&quot;, text: text &#125;],</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  const r = await fetch(url, &#123;</span><br><span class="line">    method: &quot;POST&quot;,</span><br><span class="line">    headers: &#123;</span><br><span class="line">      &quot;Content-Type&quot;: &quot;application/json&quot;,</span><br><span class="line">      &quot;Authorization&quot;: `Bearer $&#123;TOKEN&#125;`,</span><br><span class="line">    &#125;,</span><br><span class="line">    body: body,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  if (!r.ok) &#123;</span><br><span class="line">    console.error(&quot;Line Reply API Failed:&quot;, await r.json());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// API：推播line訊息</span><br><span class="line">const sendLineMessage = async (req, res) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  // 設定 CORS</span><br><span class="line">  setCorsHeaders(res); // 設定 CORS</span><br><span class="line">  //res.set(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);</span><br><span class="line">  //res.set(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, OPTIONS&quot;);</span><br><span class="line">  //res.set(&quot;Access-Control-Allow-Headers&quot;, &quot;Content-Type&quot;);</span><br><span class="line"></span><br><span class="line">  // 處理預檢請求</span><br><span class="line">  if (req.method === &quot;OPTIONS&quot;) &#123;</span><br><span class="line">    return res.status(204).send(&#x27;&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // GET 測試路徑</span><br><span class="line">  if (req.method === &quot;GET&quot;) &#123;</span><br><span class="line">    return res.status(200).send(&quot;✅ LINE Proxy Service is running&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (req.method === &quot;POST&quot;) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      const &#123; message, to &#125; = req.body || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">      const r = await fetch(&quot;https://api.line.me/v2/bot/message/push&quot;, &#123;</span><br><span class="line">        method: &quot;POST&quot;,</span><br><span class="line">        headers: &#123;</span><br><span class="line">          &quot;Content-Type&quot;: &quot;application/json&quot;,</span><br><span class="line">          &quot;Authorization&quot;: `Bearer $&#123;TOKEN&#125;`,</span><br><span class="line">        &#125;,</span><br><span class="line">        body: JSON.stringify(&#123;</span><br><span class="line">          to: to || USER_ID,</span><br><span class="line">          messages: [&#123; type: &quot;text&quot;, text: message || &quot;No message&quot; &#125;],</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      const data = await r.json();</span><br><span class="line">      return res.status(200).json(data);</span><br><span class="line"></span><br><span class="line">    &#125; catch (err) &#123;</span><br><span class="line">      console.error(err);</span><br><span class="line">      return res.status(500).send(&quot;發送失敗&quot; + err);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 其他方法</span><br><span class="line">  res.status(405).send(&quot;Method Not Allowed&quot;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// API：取得目前時間</span><br><span class="line">const getCurrentTime = (req, res) =&gt; &#123;</span><br><span class="line">  setCorsHeaders(res); // 設定 CORS</span><br><span class="line"></span><br><span class="line">  if (req.method === &quot;OPTIONS&quot;) &#123;</span><br><span class="line">    return res.status(204).send(&#x27;&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (req.method === &quot;GET&quot;) &#123;</span><br><span class="line">    const now = new Date();</span><br><span class="line">    return res.status(200).json(&#123; time: now.toISOString() &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  res.status(405).send(&quot;Method Not Allowed&quot;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 路由器函數</span><br><span class="line">const router = (req, res) =&gt; &#123;</span><br><span class="line">  const path = req.path; // 取得 URL 路徑</span><br><span class="line"></span><br><span class="line">  switch (path) &#123;</span><br><span class="line">    case &#x27;/sendLineMessage&#x27;:</span><br><span class="line">      return sendLineMessage(req, res);</span><br><span class="line">    case &#x27;/getCurrentTime&#x27;:</span><br><span class="line">      return getCurrentTime(req, res);</span><br><span class="line">    case &#x27;/lineWebhook&#x27;: // 新增 Line Webhook 路徑</span><br><span class="line">      return handleLineWebhook(req, res);      </span><br><span class="line">    default:</span><br><span class="line">      res.status(404).send(&#x27;Not Found&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">functions.http(&#x27;router&#x27;, router); // 將 router 函數指定為進入點</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><h5 id="儲存後重新佈署"><a href="#儲存後重新佈署" class="headerlink" title="儲存後重新佈署"></a>儲存後重新佈署</h5></li>
</ol>
<img src="/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/build.jpg" class="" title="build">
<h1 id="-8"><a href="#-8" class="headerlink" title=""></a></h1><h1 id="-9"><a href="#-9" class="headerlink" title=""></a></h1><h1 id="-10"><a href="#-10" class="headerlink" title=""></a></h1><h1 id="-11"><a href="#-11" class="headerlink" title=""></a></h1><h1 id="-12"><a href="#-12" class="headerlink" title=""></a></h1><hr>
<h3 id="Line-Develope-設定"><a href="#Line-Develope-設定" class="headerlink" title="Line Develope 設定"></a>Line Develope 設定</h3><ol>
<li><h5 id="到Line-Develope的Messaging-API頁籤把Webhook-URL替換成剛剛的Cloud-Run網址，並且要記得把Use-webhook打開"><a href="#到Line-Develope的Messaging-API頁籤把Webhook-URL替換成剛剛的Cloud-Run網址，並且要記得把Use-webhook打開" class="headerlink" title="到Line Develope的Messaging API頁籤把Webhook URL替換成剛剛的Cloud Run網址，並且要記得把Use webhook打開"></a>到Line Develope的Messaging API頁籤把Webhook URL替換成剛剛的Cloud Run網址，並且要記得把Use webhook打開</h5></li>
</ol>
<img src="/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/open_webhook.jpg" class="" title="open_webhook">
<ol start="2">
<li><h5 id="點選Verify按鈕，如果正常呼叫會出現Success的提示視窗。"><a href="#點選Verify按鈕，如果正常呼叫會出現Success的提示視窗。" class="headerlink" title="點選Verify按鈕，如果正常呼叫會出現Success的提示視窗。"></a>點選Verify按鈕，如果正常呼叫會出現Success的提示視窗。</h5></li>
</ol>
<h1 id="-13"><a href="#-13" class="headerlink" title=""></a></h1><h1 id="-14"><a href="#-14" class="headerlink" title=""></a></h1><h1 id="-15"><a href="#-15" class="headerlink" title=""></a></h1><h1 id="-16"><a href="#-16" class="headerlink" title=""></a></h1><hr>
<h3 id="取得goupId"><a href="#取得goupId" class="headerlink" title="取得goupId"></a>取得goupId</h3><ol>
<li><h5 id="到Line群組織中隨便發個訊息。"><a href="#到Line群組織中隨便發個訊息。" class="headerlink" title="到Line群組織中隨便發個訊息。"></a>到Line群組織中隨便發個訊息。</h5></li>
<li><h5 id="再回到Cloud-Run觀看Log，可以看到我們剛剛發送訊息後，Log記錄到的Payload內容。其中有一個欄位goupId就是我們要的東西"><a href="#再回到Cloud-Run觀看Log，可以看到我們剛剛發送訊息後，Log記錄到的Payload內容。其中有一個欄位goupId就是我們要的東西" class="headerlink" title="再回到Cloud Run觀看Log，可以看到我們剛剛發送訊息後，Log記錄到的Payload內容。其中有一個欄位goupId就是我們要的東西!"></a>再回到Cloud Run觀看Log，可以看到我們剛剛發送訊息後，Log記錄到的Payload內容。其中有一個欄位goupId就是我們要的東西!</h5></li>
</ol>
<img src="/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/test_result.jpg" class="" title="test_result">
<h1 id="-17"><a href="#-17" class="headerlink" title=""></a></h1><h1 id="-18"><a href="#-18" class="headerlink" title=""></a></h1><h1 id="-19"><a href="#-19" class="headerlink" title=""></a></h1><h1 id="-20"><a href="#-20" class="headerlink" title=""></a></h1><hr>
<h3 id="測試"><a href="#測試" class="headerlink" title="測試"></a>測試</h3><ol>
<li><h5 id="把line推播API的to參數換成剛剛取得的goupId。"><a href="#把line推播API的to參數換成剛剛取得的goupId。" class="headerlink" title="把line推播API的to參數換成剛剛取得的goupId。"></a>把line推播API的to參數換成剛剛取得的goupId。</h5></li>
</ol>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const r = await fetch(&quot;https://api.line.me/v2/bot/message/push&quot;, &#123;</span><br><span class="line">  method: &quot;POST&quot;,</span><br><span class="line">  headers: &#123;</span><br><span class="line">    &quot;Content-Type&quot;: &quot;application/json&quot;,</span><br><span class="line">    &quot;Authorization&quot;: `Bearer $&#123;TOKEN&#125;`,</span><br><span class="line">  &#125;,</span><br><span class="line">  body: JSON.stringify(&#123;</span><br><span class="line">    to: to || &#123;把剛剛的groupId貼到這裡來&#125;,</span><br><span class="line">    messages: [&#123; type: &quot;text&quot;, text: message || &quot;No message&quot; &#125;],</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h1 id="-21"><a href="#-21" class="headerlink" title=""></a></h1><h1 id="-22"><a href="#-22" class="headerlink" title=""></a></h1><h1 id="-23"><a href="#-23" class="headerlink" title=""></a></h1><h1 id="-24"><a href="#-24" class="headerlink" title=""></a></h1><hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/" data-id="cmir9chy2000a8gn143ncablr" data-title="Line-API-群組推播" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cloud-Run/" rel="tag">Cloud Run</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2025/12/03/Google-App-Script-GAS-%E6%87%89%E7%94%A8/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Google App Script(GAS)應用
        
      </div>
    </a>
  
  
    <a href="/2025/10/22/Simple-Docker-App/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Simple-Docker-App</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/GCP/">GCP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/">前端開發</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%87%AA%E5%8B%95%E5%8C%96/">自動化</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cloud-Run/" rel="tag">Cloud Run</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker-Compose/" rel="tag">Docker Compose</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DockerFile/" rel="tag">DockerFile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GAS/" rel="tag">GAS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/" rel="tag">Ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WSL2/" rel="tag">WSL2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/" rel="tag">Webpack</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Cloud-Run/" style="font-size: 10px;">Cloud Run</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Docker-Compose/" style="font-size: 10px;">Docker Compose</a> <a href="/tags/DockerFile/" style="font-size: 10px;">DockerFile</a> <a href="/tags/GAS/" style="font-size: 10px;">GAS</a> <a href="/tags/Ubuntu/" style="font-size: 20px;">Ubuntu</a> <a href="/tags/WSL2/" style="font-size: 20px;">WSL2</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/12/">December 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">October 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">September 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/12/03/Google-App-Script-GAS-%E6%87%89%E7%94%A8/">Google App Script(GAS)應用</a>
          </li>
        
          <li>
            <a href="/2025/10/28/Line-API-%E7%BE%A4%E7%B5%84%E6%8E%A8%E6%92%AD/">Line-API-群組推播</a>
          </li>
        
          <li>
            <a href="/2025/10/22/Simple-Docker-App/">Simple-Docker-App</a>
          </li>
        
          <li>
            <a href="/2025/10/01/Docker-with-WSL2-3-DockerCompose/">Docker with WSL2(3) - 利用Docker Compose達到熱重載效果</a>
          </li>
        
          <li>
            <a href="/2025/09/25/Docker-with-WSL2-2/">Docker with WSL2(2) - Dockerfile</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>